<!DOCTYPE html>
<html>
<head>

</head>
<body >


<label for="books">Choose a Book:</label>
<select name="books" id="books">
    <option value="Clean Code-Robert Martin-50.0">Clean Code</option>
    <option value="The Clean Coder-Robert Martin-50.0">The Clean Coder</option>
    <option value="Clean Architecture-Robert Martin-50.0">Clean Architecture</option>
    <option value="Working Effectively with Legacy Code-Michael C. Feathers-50.0">Working Effectively with Legacy Code</option>
    <option value="The Driven Development By Example-Kent Beck-50.0">The Driven Development By Example</option>
</select>
<br><br>
<Button onClick="send()">Add To Cart</Button>
<Button onClick="getBill()">Get Bill</Button>
<Button onClick="clearCart()">Clear Cart</Button>
<div id="bill">

</div>

</body>

<script>
function send(){

     const values = document.getElementById('books').value.split('-');

    const json = {
                  name: values[0],
                  writer: values[1],
                  price: values[2]
            };
    const xhr = new XMLHttpRequest();
    xhr.open("POST", "http://localhost:8080/addbook");

            // set `Content-Type` header
            xhr.setRequestHeader("Content-Type",
                                 "application/json");

            // send request with JSON payload
            xhr.send(JSON.stringify(json));



}

function getBill(){

var xh = new XMLHttpRequest();
             xh.onreadystatechange = function() {
                if (xh.readyState == XMLHttpRequest.DONE) {

                    const myObj = JSON.parse(this.responseText);
                    let text = "<table border='1'><tr><th>Books</th><th>Actual Price </th><th>Discounted Price</th><th>Total Discount</th></tr>"

                    for (let x in myObj.groups) {
                    let book = '' ;
                        for (let y in myObj.groups[x].books) {
                    book += myObj.groups[x].books[y].name + "</br>";
                    }text += "<tr><td>"+book+"</td><td>" + myObj.groups[x].actualPrice + "</td><td>"
                     + myObj.groups[x].discountedPrice + "</td><td>"
                     + myObj.groups[x].totalDiscount + "</td></tr>";
                    }
                     text += "<tr><table border ='1'><tr><th>Actual Cost</th><th>Final Cost</th><th>Total Discount</th></tr><tr><td>"+myObj.actualCost+"</td><td>"+myObj.finalCost+"</td><td>"+myObj.totalDiscount+"</td><tr/></table><tr></table>"
                    document.getElementById("bill").innerHTML = text;
                 }
            }
        xh.open('GET', 'http://localhost:8080/getBill', true);
        xh.send(null);

}

function clearCart(){
     const xhr = new XMLHttpRequest();
     xhr.open("DELETE", "http://localhost:8080/clearCart");
     xhr.send(null);
     document.getElementById("bill").innerHTML = '';Ã’
}

</script>
</html>